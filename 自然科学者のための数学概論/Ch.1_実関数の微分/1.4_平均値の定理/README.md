# 1.4 平均値の定理 - 視覚化ツール

このプロジェクトは、微分積分学における重要な定理の一つである「平均値の定理」を幾何学的に理解するための視覚化ツールです。

## 定理の概要と視覚化の意味

平均値の定理は、「ある区間 $[a, b]$ で連続かつ微分可能な関数 $f(x)$ において、その区間内の平均変化率（割線の傾き）と等しい微分係数（接線の傾き）を持つ点 $c$ が区間内に少なくとも一つ存在する」ことを主張します。

$$f'(c) = \frac{f(b) - f(a)}{b - a} \quad (a < c < b)$$

本ツールでは、グラフ上の2点 $A, B$ を自由に動かすことで、その間の割線と「平行な接線」が常にどこに現れるかをリアルタイムに確認できます。

## 主要なアルゴリズムの意図

### 汎用的な点 $c$ の探索 (`findMeanValuePoint`)
特定の関数（例：$y=x^2$）に依存せず、あらゆる関数で $c$ を見つけられるように**数値探索アルゴリズム**を採用しています。

1.  **補助関数の導入**: ロルの定理の証明と同様に、$h(x) = f(x) - kx$ （$k$ は割線の傾き）を考えます。
2.  **幾何学的解釈**: この $h(x)$ は、元の曲線と割線の「垂直方向の距離」に相当します。
3.  **極値探索**: 曲線が割線から最も離れる場所（山や谷）では、必ず接線が水平（$h'(c)=0$）になります。これは元のグラフで見れば、接線が割線と平行になる点 $c$ そのものです。
4.  **数値サンプリング**: 区間内を 400 分割してサンプリングし、この距離が最大になる $x$ 座標を点 $c$ として特定します。

## ファイル構成と役割

| ファイル名 | 役割 |
| :--- | :--- |
| `index.html` | プログラムのエントリポイント。p5.js ライブラリと `sketch.js` を読み込みます。 |
| `config.js` | キャンバスサイズ、グリッドスケール、テーマカラー（グラフ、接線、割線など）を管理します。 |
| `math-utils.js` | 数学的な計算のコア。座標変換、数値微分、そして本ツールの要である点 $c$ の数値探索を担います。 |
| `drawing-utils.js` | p5.js を用いた描画補助。グリッド、主軸、関数グラフ、および接線や割線の描画ロジックを含みます。 |
| `sketch.js` | メインプログラム。ユーザーのマウス操作（A点・B点の移動）を受け取り、全体の描画フローを制御します。 |

## 処理の流れ

1.  **入力**: ユーザーがマウスをクリックまたはドラッグして、グラフ上の 2 点 $A, B$ を決定します。
2.  **計算**: 
    *   2 点を通る割線の傾き $k$ を求める。
    *   `findMeanValuePoint` が区間 $[a, b]$ をサンプリングし、平均値の定理を満たす点 $c$ を特定する。
3.  **描画**:
    *   元の関数 $f(x)$ の曲線をプロット。
    *   点 $A, B$ を結ぶ割線（オレンジ色の点線）を描画。
    *   点 $c$ における接線（緑色の実線）を描画。割線と平行であることを視覚的に示します。
    *   それぞれの傾きの数値をキャンバス上に表示し、理論的な一致を確認できるようにします。

## 使い方
*   キャンバス上のグラフ付近をクリックまたはドラッグすると、近い方の端点（A点またはB点）が移動します。
*   端点を動かすたびに、平行な接線が自動的に追従して描画されます。
